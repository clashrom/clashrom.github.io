<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Reloj & Clima</title>
<style>
  :root{
    --sky-day:linear-gradient(to top,#4aa9ff,#87cefa);
    --sky-night:linear-gradient(to top,#001b3d,#003366);
    --sky-overcast:linear-gradient(to top,#5b6d7a,#95a4b3);
  }
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Segoe UI',sans-serif;color:#fff;text-align:center;overflow:hidden;height:100vh}
  .sky{position:fixed;inset:0;background:var(--sky-day);transition:background 1s;z-index:-3}
  .mountains{position:absolute;bottom:0;width:100%;height:32%;background:linear-gradient(to top,#5a9132,#7abe45);border-top-left-radius:100% 20%;border-top-right-radius:100% 20%;z-index:-2}
  .sun,.moon{position:absolute;top:10%;left:50%;translate:-50% 0;width:80px;height:80px;border-radius:50%;box-shadow:0 0 30px rgba(255,255,100,.5);transition:opacity 1s}
  .sun{background:#ffdb4d}
  .moon{background:#ccc;box-shadow:0 0 20px #ccc}
  /*Â TextoÂ ------------------------------------------------------------- */
  .time{padding-top:45%;font-size:3.4em}
  .date{margin-top:.5em;font-size:1.2em}
  .weather{margin-top:1.5em;font-size:1em;display:flex;flex-direction:column;gap:.3em}
  /*Â Efectos comunesÂ ----------------------------------------------------*/
  .effect{position:fixed;inset:0;pointer-events:none;z-index:2}
  /*â€ŠLluviaÂ */
  .rain{background-image:url('https://i.imgur.com/NM4SokO.png');background-size:cover;opacity:.3;animation:rain 1s linear infinite}
  @keyframes rain{from{background-position:0 0}to{background-position:0 100%}}
  /*â€ŠNieveÂ */
  .snow{background-image:url('https://i.imgur.com/13p62dP.png');background-size:contain;opacity:.5;animation:snow 8s linear infinite}
  @keyframes snow{from{background-position:0 -100%}to{background-position:0 100%}}
  /*â€ŠNieblaÂ */
  .fog{background:radial-gradient(circle at 50% 120%,rgba(255,255,255,.6),rgba(255,255,255,0) 60%);backdrop-filter:blur(2px);animation:fog 12s ease-in-out infinite}
  @keyframes fog{0%,100%{transform:translateX(-10%)}50%{transform:translateX(10%)}}
  /*â€ŠNubes sueltasÂ */
  .clouds-few::before,.clouds-few::after,
  .clouds-overcast::before,.clouds-overcast::after{
    content:'';position:absolute;top:10%;left:-30%;width:160px;height:90px;background:#fff;border-radius:50%;box-shadow: -40px 10px 0 10px #fff;opacity:.8;
    animation:cloud 60s linear infinite}
  .clouds-few::after{top:35%;animation-duration:80s}
  .clouds-overcast::before{opacity:.9;filter:brightness(.85)}
  .clouds-overcast::after{top:25%;opacity:.9;animation-duration:70s;filter:brightness(.8)}
  @keyframes cloud{to{transform:translateX(130vw)}}
  /*â€ŠViento (hojas que pasan)â€¯â†’ solo un detalle ligeroÂ */
  .wind{background-image:url('https://i.imgur.com/5dCx1fi.png');background-size:200px;animation:wind 4s linear infinite}
  @keyframes wind{from{background-position:-200px 0}to{background-position:calc(100% + 200px) 0}}
</style>
</head>
<body>
  <div id="sky" class="sky"></div>
  <div class="sun" id="sun"></div>
  <div class="moon" id="moon"></div>
  <div class="mountains" id="mount"></div>

  <div class="time" id="time">--:--</div>
  <div class="date" id="date">Fecha...</div>
  <div class="weather" id="weather">
    <span id="city">---</span>
    <span id="details">Cargando clima...</span>
  </div>

<script>
const $ = id=>document.getElementById(id);

function pad(n){return n.toString().padStart(2,'0');}
function setText(){
  const now=new Date(),h=now.getHours(),m=now.getMinutes();
  $('time').textContent=`${pad(h)}:${pad(m)}`;
  $('date').textContent=now.toLocaleDateString('es-ES',{weekday:'long',day:'numeric',month:'long',year:'numeric'});
  // DÃ­a/noche
  const sky=$('sky'),sun=$('sun'),moon=$('moon');
  if(h>=6&&h<18){sky.style.background='var(--sky-day)';sun.style.opacity=1;moon.style.opacity=0;}
  else{sky.style.background='var(--sky-night)';sun.style.opacity=0;moon.style.opacity=1;}
}
setText();setInterval(setText,60*1000);

//Â Clima ------------------------------------------------------------------
const key="b66c9112b020cbc90a49476edb3d15ae";
navigator.geolocation.getCurrentPosition(({coords})=>{
  fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${coords.latitude}&lon=${coords.longitude}&appid=${key}&units=metric&lang=es`)
  .then(r=>r.json()).then(drawWeather);
},()=>$('details').textContent="UbicaciÃ³n denegada");

function drawWeather(d){
  const main=d.weather[0].main.toLowerCase(),
        desc=d.weather[0].description,
        clouds=d.clouds.all,
        wind=d.wind.speed;
  $('city').textContent=`ðŸ“Â ${d.name}`;
  $('details').textContent=`ðŸŒ¡ï¸Â ${d.main.temp.toFixed(1)}Â°CÂ |Â ðŸŒ¬ï¸Â ${wind}â€¯m/sÂ |Â ${desc}`;
  const sky=$('sky');
  // Primero, limpia efectos anteriores
  document.querySelectorAll('.effect').forEach(e=>e.remove());

  // Helpers
  const addEff=cls=>{
    const div=document.createElement('div');div.className=`effect ${cls}`;document.body.append(div);
  };

  // Lluvia
  if(main==='rain'||main==='drizzle'){addEff('rain');}
  // Nieve
  if(main==='snow'){addEff('snow');}
  // Niebla / bruma
  if(['mist','fog','haze','smoke'].includes(main)){addEff('fog');}
  // Nubes (usamos porcentaje)
  if(main==='clouds'){
    if(clouds<40){addEff('clouds-few');}
    else {addEff('clouds-overcast');sky.style.background='var(--sky-overcast)';}
  }
  // Viento fuerte (>8â€¯m/s) â€“simple detalle
  if(wind>8){addEff('wind');}
}
</script>
</body>
</html>
